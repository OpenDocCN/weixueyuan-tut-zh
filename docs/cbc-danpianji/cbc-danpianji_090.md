# C 语言指针的简单示例

前边我们提到了，指针的意义往往在小程序里是体现不出来的，对于简单程序来说，有时候用了指针，反而可能比没用指针还麻烦，但是为了让大家巩固一下指针的用法，我还是写了个使用指针的流水灯程序，目的是让大家从简单程序开始了解指针，当程序复杂的时候不至于手足无措。

```
#include <reg52.h>
sbit ADDR0 = P1⁰;
sbit ADDR1 = P1¹;
sbit ADDR2 = P1²;
sbit ADDR3 = P1³;
sbit ENLED = P1⁴;
void ShiftLeft(unsigned char *p);

void main(){
    unsigned int i;
    unsigned char buf = 0x01;

    ENLED = 0; //使能选择独立 LED
    ADDR3 = 1;
    ADDR2 = 1;
    ADDR1 = 1;
    ADDR0 = 0;

    while (1){
        P0 = ~buf; //缓冲值取反送到 P0 口
        for (i=0; i<20000; i++); //延时
        ShiftLeft(&buf); //缓冲值左移一位
        if (buf == 0){ //如移位后为 0 则重赋初值
            buf = 0x01;
        }
    }
}
/* 将指针变量 p 指向的字节左移一位 */
void ShiftLeft(unsigned char *p){
    *p = *p << 1; //利用指针变量可以向函数外输出运算结果
}
```

这是一个使用指针实现流水灯的例子，纯粹是为了讲指针而写这样一段程序，程序中传递的是 buf 的地址，把这个地址直接传递给函数 ShiftLeft 的形参指针变量 p，也就是 p 指向了 buf。对比之前的函数调用，大家是否看明白，如果是普通变量传递，只能单向的，也就是说，主函数传递给子函数的值，子函数只能使用却不能改变。而现在我们传递的是指针，不仅仅子函数可以使用 buf 里边的值，而且还可以对 buf 里边的值进行修改。

此外再强调一句，只要是*p 前边带了变量类型如 unsigned char，就是表示定义了一个指针变量 p，而执行代码中的*p，是指 p 所指向的内容。

通过理论的学习和这样一个例程，我想大家对指针应该有概念了，至于它的灵活应用，需要我们在后边的程序中慢慢去体会，理论上就不再过多赘述了。