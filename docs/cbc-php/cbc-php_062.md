# PHP addslashes()和 stripslashes()：字符串转义与还原

> 原文：[`c.biancheng.net/view/7413.html`](http://c.biancheng.net/view/7413.html)

在 PHP 编程的过程中，经常会遇到这样的问题，将数据插入到数据库时可能引起一些问题，比如出现错误或者乱码等。这是因为数据库将传入的数据中的字符解释成控制符。针对这种问题，就需要使用一种标记或者是转义这些特殊的字符。

在 PHP 中提供了专门处理这些问题的技术，转义和还原字符串的方法有两种，一种是手动转义、还原字符串，另一种是自动转义、还原字符串。下面分别对这两种方法进行讲解。

## 1、手动转义、还原字符串

字符串可以用单引号`' '`、双引号`" "`、定界符`<<<`3 种方式定义，其中最简单的方法就是使用单引号`' '`来定义字符串。当使用字符串时，字符串中很可能也需要使用这几个定义字符串的符号来作为字符串的一部分，为了避免混淆，就必须在这些符号的前面使用转移符`\`。

`\`是一个转义符，紧跟在`\`后面的第一个字符将变为没有意义或特殊意义的字符。例如，`'`是定义字符串的特殊符号，而写成`\'`后，就失去了它定义字符串的功能了，变为普通的单引号了。我们可以使用`echo "\'";`来输出一个单引号，转义符`\`不会显示。

【示例】使用转义字`\`对字符串进行转义。

```

<?php
    echo 'Name：\'C 语言中文网\'<br>Url：\'http://c.biancheng.net/php/\'';
?>
```

运行结果如下：

Name：'C 语言中文网'
Url：'http://c.biancheng.net/php/'

对于简单的字符串，建议采用手动方法进行字符串转义，而对于数据量较大的字符串，建议采用自动转义函数实现字符串的转义。

## 2、自动转义、还原字符串

自动转义、还原字符串可以使用 PHP 提供的 addslashes() 函数和 stripslashes() 函数实现。

#### 1) addslashes() 函数

addslashes() 函数的作用是给字符串加入`\`，对指定的字符串进行转义，语法格式如下：

addslashes($str)

其中，$str 为要转义的字符串。

addslashes() 函数返回的字符串中，为了数据库查询等语句的需要，会在某些字符前加上了反斜线，这些字符是单引号`'`、双引号`"`、反斜线`\`与 NULL。

#### 2) stripslashes() 函数

stripslashes() 函数的作用是还原一个被转义的字符串，也就是去除在字符串中加入的反斜线，语法格式如下：

stripslashes($str)

其中，$str 为需要还原的字符串。

stripslashes() 函数会返回一个去除转义反斜线后的字符串（`\'`转换为`'`，双反斜线`\\`被转换为单个反斜线`\`）。

【示例】使用 addslashes() 函数对字符串进行转义，然后使用 stripslashes() 函数进行还原。

```

<?php
    $sql = "select * from php where website='C 语言中文网'";
    $str = addslashes($sql);
    echo $str.'<br>';
    $str = stripslashes($str);
    echo $str;
?>
```

运行结果如下：

select * from php where website=\'C 语言中文网\'
select * from php where website='C 语言中文网'